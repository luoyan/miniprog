/*! page - v1.0.0 - 2013-11-07 */
define("js/page/goldmall",["./base","jquery","jqueryplugins","Boxy"],function(a,b,c){function d(){$("#job_6").poshytip({content:'<div class="tips-ctn">分享“优惠推荐”中的优惠信息到QQ空间即可获得金币，每天前五次分享共可获得15个金币（每次3个）</div>',className:"tip-gray",showTimeout:0,offsetY:10,alignTo:"target",alignX:"center",live:!0,allowTipHover:!0}),$(".earn-gold").delegate("a","click",function(){var a=$.cookie("od");if(a){var b=this,c=a,d=$(this).attr("job_id");if(6!=d&&!$(this).parent().hasClass("disabled")){if(MM.ajaxPost("/add_user_gold",{id:c,job_id:d},function(a){if(a.success){var c=$(b).offset(),e=$(b).attr("data-gold")-0,f=$("#signin_days").text()-0;1==d&&(e=f+1,e>7&&(e=7));var h=$("#jifen").text()-0+e;$("<div class='add-gold'>+"+e+"</div>").css({top:c.top-20,left:c.left}).appendTo("body").fadeOut(1e3,function(){if($("#jifen").text(h),1==d){$("#signin_days").text(f+1);var a=e+1;a>7&&(a=7);var b='<div class="warn-tips-ctn"><h1>明天再来可以领取到<span class="warn">'+a+'</span>个金币</h1><p>连续领取天数越多获得的金币也越多最多不超过7个</p><div><a class="set-qqwarn" id="warn_tomorrow" target="_blank" href="'+g.comm.signin_warn_url+'">点击添加明天签到提醒</a>(仅提醒一次)</div></div>';$("#sign_in").poshytip("update",b),$("#sign_in").addClass("disabled")}}),$(b).parent().addClass("disabled")}}),4==d&&g.comm.addFavorite("http://ztmhs.maimiaotech.com","真划算"),3==d)return $(b).attr("href",$("#addQQ").attr("href")).attr("target","_blank"),!0;if(5==d)return $(b).attr("href",g.comm.signin_warn_url).attr("target","_blank"),!0}}else new h($("#login_prompt").html(),{modal:!0,title:" ",closeText:"x"});return!1}),$(".exchange-item-list").delegate(".exchange-btn","click",function(){if(!$(this).hasClass("disabled"))if($.cookie("od")){j=$(this).parent().parent().find(".cost").text()-0,f=this;var a=$("#jifen").text()-0;if(j>a)alert("您的金币不够");else{for(var b=$(this).attr("data").split(","),c={item_id:$(this).attr("data-id"),reqs:[]},d=0,g=b.length;g>d;d++)c.reqs.push({title:b[d]});e=new h($("#itemPopupTmpl").tmpl(c).html(),{modal:!0,title:" ",closeText:"x"})}}else new h($("#login_prompt").html(),{modal:!0,title:" ",closeText:"x"})}),$("body").delegate(".popup-ctn .confirm","click",function(){var a=!0,b="";return $(".popup-ctn:visible table tr").each(function(c,d){b+='<span class="name">'+$(".item-title",d).text()+'</span>是<span class="value">'+$(".item-value",d).val()+"</span>，",""==$(".item-value",d).val()&&(a=!1)}),a?($(".popup-ctn .input-ctn").hide(),$(".popup-ctn #submit_values").html(b),$(".popup-ctn .submit-ctn").show(),void 0):(alert("请将信息填写完整"),!1)}),$("body").delegate(".popup-ctn .submit","click",function(){var a=[],b=[];$(".popup-ctn:visible table tr").each(function(c,d){a.push($(".item-title",d).text()),b.push($(".item-value",d).val())});var c={id:$.cookie("od"),item_id:$(this).attr("data-id"),info_title:a,info_value:b};g.ajaxPost("/exchange_item",c,function(a){a.success?($(".popup-ctn .submit-ctn").hide(),$(".popup-ctn .result-ctn").show(),$("#jifen").text($("#jifen").text()-j),$(f).addClass("disabled"),$(f).parent().parent().find(".tip").text("您今天已经兑换过该产品")):(e.hide(),alert(a.data))})})}var e,f,g=a("./base"),h=a("Boxy"),i={},j=0;i.init=function(){d()},c.exports=i});